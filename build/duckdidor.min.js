!function(){function a(a,b){function c(a){return a*a}var d=Math.sqrt(c(b.x-a.x)+c(b.y-a.y));return d}function b(a){a=a||window.event,a.preventDefault&&a.preventDefault(),a.returnValue=!1}var c=(console.log.bind(console),console.info.bind(console)),d=(console.warn.bind(console),console.error.bind(console),function(){function b(){if(C=0,G=100,D=0,E=0,I=3*Phaser.Timer.SECOND,H=!1,v=null,u&&(u.delay=I,u.timer.resume()),t&&(t.reload(),t.reload(),t.reload(),t.reload(),t.reload()),r&&(r.score.changeText("0"),r.duckPoin.changeText("0"),r.targetPoin.changeText("0")),M.bggroup){for(var a=M.bggroup.length-1;a>0;)M.bggroup.getChildAt(a).destroy(),a--;P+=1,P>=O.length&&(P=0),Q=O[P],c(Q),M.bg.frameName=Q.bg,p.grass1.frameName=Q.b1,p.grass2.frameName=Q.b2}}function d(){M.bg=B.add.tileSprite(0,0,f.width,f.height,"stall",Q.bg),M.bggroup=B.add.group(),M.bggroup.add(M.bg),p=B.add.group(),M.dashboard=B.add.sprite(0,f.height-115,"stand"),M.curtainTop=B.add.tileSprite(0,40,f.width,63,"stall","curtain_top"),M.curtain=B.add.sprite(0,0,"stall","curtain"),M.curtain2=B.add.sprite(0,0,"stall","curtain"),M.curtain2.scale.set(-1,1),M.curtain2.position.set(f.width,0),M.curtainStraight=B.add.tileSprite(0,0,f.width,80,"stall","curtain_straight"),p.grass1=new Phaser.TileSprite(B,-150,f.height,f.width+150,200,"stall",Q.b1),p.grass1.anchor.set(0,1),p.grass2=new Phaser.TileSprite(B,-100,f.height+20,f.width+100,200,"stall",Q.b2),p.grass2.anchor.set(0,1),p.add(p.grass1),p.add(p.grass2),B.add.tween(p.grass1).to({x:0},4e3,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0),B.add.tween(p.grass2).to({x:0},2500,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0),q=B.add.sprite(0,0,"hud",Q.crosshair),q.anchor.set(.5,.5),s=B.add.sprite(f.width,f.height+150,"objects","rifle"),s.anchor.set(1,1),r=B.add.group(),r.coinIcon=B.add.sprite(70,15,"coin_gold"),r.coinIcon.scale.set(.6,.6),r.add(r.coinIcon),r.score=h("0","_small"),r.score.position.set(r.coinIcon.x+r.coinIcon.width+10,20),r.score.scale.set(.8,.8),r.add(r.score),r.iconDuck=B.add.sprite(600,20,"hud","icon_duck"),r.add(r.iconDuck),r.duckPoin=h("0","_small"),r.duckPoin.position.set(r.iconDuck.x+r.iconDuck.width+10,22),r.duckPoin.scale.set(.8,.8),r.add(r.duckPoin),r.iconTarget=B.add.sprite(700,20,"hud","icon_target"),r.add(r.iconTarget),r.targetPoin=h("0","_small"),r.targetPoin.position.set(r.iconTarget.x+r.iconTarget.width+10,22),r.targetPoin.scale.set(.8,.8),r.add(r.targetPoin),v=B.add.image(10,10,"fullscreen-icon"),v.scale.set(.9,.9),v.inputEnabled=!0,v.events.onInputDown.add(function(){f.scale.isFullScreen?f.scale.stopFullScreen():f.scale.startFullScreen(!1)},this),w=B.add.sprite(80,f.height-13,"sounds","sound_on"),w.anchor.set(0,1),w.inputEnabled=!0,w.events.onInputUp.add(function(){N.bgm.isPlaying?(N.bgm.stop(),w.frameName="sound_off"):(N.bgm.loopFull(1),w.frameName="sound_on")}),x=B.add.sprite(10,f.height-10,"question"),x.anchor.set(0,1),x.inputEnabled=!0,x.events.onInputUp.add(function(){function a(){A.destroy(),A=null}A?a():(A=B.add.image(50,20,"credits"),A.inputEnabled=!0,A.events.onInputUp.add(a))}),y=B.add.sprite(140,f.height-10,"joystick"),y.anchor.set(0,1),y.inputEnabled=!0,y.events.onInputUp.add(function(){function a(){z.destroy(),z=null}z?a():(z=B.add.image(50,20,"tutorial"),z.inputEnabled=!0,z.events.onInputUp.add(a))})}function e(b,c){function d(c,d){if(t.shot()){var i=h.create(d.position.x-e.x,d.position.y-e.y,"objects","shot_blue_small");i.anchor.set(.5,.5);var j={x:e.x,y:e.y-e.target.height/2};J.indexOf(b)>=0&&(j.y+=e.target.height/4);var k=10-Math.floor(a(j,f.input)/5);k=0>k?0:k,g(e.x,e.y-h.height,k),C+=k,r.score.changeText(C.toString()),e.damage+=1,N.shot.play(),e.damage>=e.maxDamage?(e.target.inputEnabled=!1,B.add.tween(h).to({y:f.height},800,Phaser.Easing.Cubic.In,!0),B.add.tween(h.scale).to({y:.4,x:.8},500,Phaser.Easing.Cubic.InOut,!0),J.indexOf(b)>=0?(D+=1,r.duckPoin.changeText(D.toString())):(E+=1,r.targetPoin.changeText(E.toString())),N.coin2.play()):N.coin.play()}}var e=B.add.group(),h=B.add.group();return e.target=h.create(0,0,"objects",b),e.add(h),e.stick=e.create(0,0,"objects",c),e.target.anchor.set(.5,1),e.stick.anchor.set(.5,1),e.stick.y=e.stick.height,e.maxDamage=3,e.damage=0,e.target.inputEnabled=!0,e.target.input.pixelPerfectClick=!0,e.target.events.onInputDown.add(d),e}function g(a,b,c){function d(){e.destroy()}var e=h("+"+c.toString(),"_small");e.x=a-e.width/2,e.y=b,B.add.tween(e).to({y:b-100,alpha:0},1e3,Phaser.Easing.Quadratic.Out,!0).onComplete.add(d)}function h(a,b,c){function d(a){for(var d=0,g=0;g<a.length;g++)" "==a[g]?d+=10:(f.create(d,0,"hud",e(a[g],b)),d+=f.getChildAt(f.children.length-1).width);if(c){var h=f.width;for(g=0;g<f.length;g++)f.getChildAt(g).x-=h}}function e(a,b){return"+"==a?"text_plus"+b:"x"==a?"text_cross"+b:":"==a?"text_dots"+b:"text_"+a+b}b=b||"";var f=B.add.group();return d(a),f.changeText=function(a){f.removeAll(),d(a)},f}function i(){N.shot=B.add.audio("shot"),N.reload=B.add.audio("reload"),N.coin=B.add.audio("coin"),N.coin2=B.add.audio("coin2"),N.bgm=B.add.audio("bgm"),N.bgm.loopFull(1)}function j(){function a(){var a=Math.floor(2*Math.random());0==a?b():d(),u.delay>1e3&&(u.delay-=50)}function b(){function a(){c("Finished"),q.stop(),o=void 0,q=void 0,i.destroy()}var b=Math.floor(2*Math.random()),d=J[Math.floor(Math.random()*J.length)],h=L[Math.floor(Math.random()*L.length)],i=e(d,h),j=250+50*Math.random(),k=j+20+30*Math.random(),l=5e3+5e3*Math.random(),m=1e3+3e3*Math.random();i.y=j,i.x=-100;var n=f.width+100;b&&(i.x=f.width+100,n=-100,i.target.scale.x=-1),p.addAt(i,g());var o=B.add.tween(i).to({x:n},l,Phaser.Easing.Linear.None,!0).onComplete.add(a),q=B.add.tween(i).to({y:k},m,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0)}function d(){function a(){B.time.events.add(Phaser.Timer.SECOND+3e3*Math.random(),b,this)}function b(){B.add.tween(j).to({y:f.height+150},400,Phaser.Easing.Quadratic.In,!0).onComplete.add(c),B.time.events.remove(b)}function c(){j.destroy()}var d=J.concat(K),h=d[Math.floor(Math.random()*d.length)],i=L[Math.floor(Math.random()*L.length)],j=e(h,i);j.x=100+Math.random()*(f.width-200),j.y=f.height+150;var k=260+40*Math.random();p.addAt(j,g()),B.add.tween(j).to({y:k},400,Phaser.Easing.Quadratic.Out,!0).onComplete.add(a)}function g(){var a=Math.floor(3*Math.random());return 0==a?0:1==a?p.getChildIndex(p.grass2)+1:p.getChildIndex(p.grass1)+1}u=B.time.events.add(I,a,this),u.loop=!0,a()}function k(){function a(){}function b(){}function d(){}function e(a,b){function c(){q.tweenDownFinish.start()}function d(){s.isShot=!1}if(t.shot()){q.tweenDown?(q.tweenDown.start(),s.isShot||B.add.tween(s).to({rotation:s.rotation+.1},400,Phaser.Easing.Cubic.Out,!0).onComplete.add(d)):(q.tweenDown=B.add.tween(q.scale).to({x:1.5,y:1.5},200,Phaser.Easing.Cubic.Out,!0),q.tweenDownFinish=B.add.tween(q.scale).to({x:1,y:1},200,Phaser.Easing.Cubic.In,!1),q.tweenDown.onComplete.add(c),q.tweenDownFinish,B.add.tween(s).to({rotation:s.rotation+.1},400,Phaser.Easing.Cubic.Out,!0).onComplete.add(d));var e=M.bggroup.create(b.position.x-M.bg.x,b.position.y-M.bg.y,"objects","shot_blue_small");e.anchor.set(.5,.5),e.alpha=.5,N.shot.play(),s.isShot=!0}}function g(a){f.input.mouse.wheelDelta==Phaser.Mouse.WHEEL_DOWN&&(h+=Math.abs(f.input.mouse.wheelDelta),h>=F&&(c("RELOAD"),t.reload(),h=0))}f.onPause.add(a),f.onResume.add(b),f.onFocus.add(d),M.bg.inputEnabled=!0,M.bg.events.onInputDown.add(e),f.input.mouse.mouseWheelCallback=g;var h=0}function l(){function a(){t.num<=0&&0>=G?n():t.num<=0&&(t.alerting.visible=!0,t.alerting.tween.resume())}function b(){t.x=f.width-150,t.y=f.height-50}function c(){t.reload()}t=B.add.group(),t.max=5,t.num=5,t.type="silver",t["long"]="short",t.number=h(G.toString(),"_small",!0),t.add(t.number),t.larik=[],t.alerting=t.create(-70,-75,"clickscroll"),t.alerting.visible=!1,t.alerting.tween=B.add.tween(t.alerting).to({alpha:0},300,Phaser.Easing.Cubic.Out,!0,0,-1,!0),t.alerting.tween.pause();for(var d=10,e=0;e<t.num;e++)t.larik.push(t.create(d,0,"hud","icon_bullet_"+t.type+"_"+t["long"])),d+=25;t.shot=function(){return!H&&(B.time.events.add(1e3,a,this),t.num>0&&f.input.y<M.dashboard.y&&f.input.y>60)?(t.larik[t.num-1].frameName="icon_bullet_empty_"+t["long"],t.num--,!0):!1},t.reload=function(){t.num<t.max&&G>0&&(t.num+=1,t.larik[t.num-1].frameName="icon_bullet_"+t.type+"_"+t["long"],N.reload.play(),t.alerting.visible&&(t.alerting.visible=!1,t.alerting.tween.pause()),G>0&&(G--,t.number.changeText(G.toString())))},b(),t.hitArea=new Phaser.Graphics(B),t.hitArea.beginFill(0,0),t.hitArea.drawRect(-90,-80,t.width+40,t.height+120),t.hitArea.endFill(),t.add(t.hitArea),t.hitArea.inputEnabled=!0,t.hitArea.events.onInputDown.add(c)}function m(){function a(){c!==!1&&c.destroy(),b.length>0?(c=h([b[0]]),c.x=f.width/2,c.y=f.height/2,c.getAt(0).anchor.set(.5,.5),c.getAt(0).position.set(0,0),b.splice(0,1),B.add.tween(c.getAt(0).scale).to({x:2,y:2},500,Phaser.Easing.Quadratic.Out,!0,0,0,!0).onComplete.add(a)):(H=!1,j())}var b=["ready","3","2","1","go"],c=!1;a()}function n(){function a(){e.destroy(),b()}function c(){e.destroy(),b(),o()}function d(a,b){function c(){B.add.tween(a.scale).to({x:1.5,y:1.5},400,Phaser.Easing.Quadratic.Out,!0)}function d(){B.add.tween(a.scale).to({x:b.x,y:b.y},400,Phaser.Easing.Quadratic.In,!0)}a.inputEnabled=!0,a.events.onInputDown.add(c),a.events.onInputOver.add(c),a.events.onInputOut.add(d)}if(!H){H=!0,u&&u.timer.pause();var e=B.add.group();e.create(0,0,"panel");e.x=f.width/2-e.width/2,e.y=f.height/2-e.height/2;var g=e.create(30,0,"hud","text_gameover");g.x=e.width/2-g.width/2,g.y=30,e.create(120,130,"coin_gold");var i=h(C.toString());i.x=200,i.y=135,e.add(i),e.create(100,220,"hud","icon_duck"),i=h(D.toString(),"_small"),i.x=150,i.y=220,e.add(i),e.create(260,220,"hud","icon_target"),i=h(E.toString(),"_small"),i.x=310,i.y=220,e.add(i);var j=e.create(110,360,"bt_home");j.anchor.set(.5,.5),d(j,{x:1,y:1}),j.events.onInputUp.add(c);var k=e.create(330,360,"bt_replay");k.anchor.set(.5,.5),k.scale.set(.9,.9),d(k,{x:.9,y:.9}),k.events.onInputUp.add(a)}}function o(){function a(){h.scale.set(1.2,1.2),h.tint=16755217}function b(){h.scale.set(1,1),h.tint=16777215}function c(){h.events.onInputOver.remove(a),h.events.onInputOut.remove(b),h.events.onInputUp.remove(c),h.destroy(),m(),e.tw1=B.add.tween(e).to({y:-800},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(d),e.tw2=B.add.tween(e).to({x:0},250,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0)}function d(){e.destroy(),g.destroy()}H=!0;var e=B.add.tileSprite(-20,0,f.width+20,f.height,"tirai"),g=B.add.sprite(f.width/2,f.height/2,"judul"),h=B.add.sprite(f.width/2,f.height/2+150,"play");e.addChild(g),g.anchor.set(.5,1),h.anchor.set(.5,.5),h.inputEnabled=!0,h.events.onInputOver.add(a),h.events.onInputOut.add(b),h.events.onInputUp.add(c),v.bringToTop(),w.bringToTop(),x.bringToTop(),y.bringToTop()}var p,q,r,s,t,u,v,w,x,y,z,A,B=this,C=0,D=0,E=0,F=3,G=100,H=!0,I=3*Phaser.Timer.SECOND,J=["duck_brown","duck_outline_brown","duck_outline_target_brown","duck_outline_target_white","duck_outline_target_yellow","duck_outline_white","duck_outline_yellow","duck_target_brown","duck_target_white","duck_target_yellow","duck_white","duck_yellow"],K=["target_colored","target_colored_outline","target_red1","target_red1_outline","target_red2","target_red2_outline","target_red3","target_red3_outline","target_white","target_white_outline"],L=["stick_metal","stick_metal_outline","stick_wood","stick_wood_outline"],M={},N={},O=[{bg:"bg_wood",b1:"grass1",b2:"grass2",crosshair:"crosshair_blue_large"},{bg:"bg_blue",b1:"water1",b2:"water2",crosshair:"crosshair_red_large"}],P=Math.floor(Math.random()*O.length),Q=O[P];this.preload=function(){c("MAIN PRELOAD"),B.add.sprite(f.width/2,f.height/4*1.5,"logo").anchor.setTo(.5,.5),B.add.sprite(f.width/2,f.height/4*3,"loader-white").anchor.setTo(.5,.5);var a=B.add.sprite(f.width/2,f.height/4*3,"loader-black");a.anchor.setTo(.5,.5),B.load.setPreloadSprite(a,0),B.load.atlasXML("stall","assets/spritesheet_stall.png","assets/spritesheet_stall.xml"),B.load.atlasXML("objects","assets/spritesheet_objects.png","assets/spritesheet_objects.xml"),B.load.atlasXML("hud","assets/spritesheet_hud.png","assets/spritesheet_hud.xml"),B.load.image("stand","assets/stand.png"),B.load.image("coin_gold","assets/coin_gold.png"),B.load.image("fullscreen-icon","assets/fullscreen-icon.png"),B.load.image("panel","assets/panel.png"),B.load.image("bt_replay","assets/replay.png"),B.load.image("play","assets/play.png"),B.load.image("bt_home","assets/home.png"),B.load.image("clickscroll","assets/clickscroll.png"),B.load.image("tirai","assets/tirai.png"),B.load.image("judul","assets/judul.png"),B.load.image("tutorial","assets/tutorial.png"),B.load.image("credits","assets/credits.png"),B.load.image("question","assets/question.png"),B.load.image("joystick","assets/joystick.png"),B.load.atlas("sounds","assets/sounds.png","assets/sounds.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),B.load.audio("shot","assets/sounds/barreta_m9-Dion_Stapper-1010051237.mp3"),B.load.audio("reload","assets/sounds/reload.mp3"),B.load.audio("coin","assets/sounds/coin1.wav"),B.load.audio("coin2","assets/sounds/coin2.wav"),B.load.audio("bgm","assets/Retro Comedy.ogg"),f.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,f.canvas.oncontextmenu=function(a){a.preventDefault()}},this.create=function(){c("MAIN CREATE"),d(),k(),i(),l(),o()},this.update=function(){f.input.y<M.dashboard.y&&f.input.y>60&&(q.position.set(f.input.x,f.input.y),s.x=f.input.x+220,s.isShot||(s.rotation=.2-f.input.y/(f.height-115)*.4))},this.render=function(){}}),e=function(){function a(){c("BOOT PRELOAD"),f.load.image("logo","assets/logo.png"),f.load.image("loader-white","assets/loader_white.png"),f.load.image("loader-black","assets/loader_black.png"),f.stage.disableVisibilityChange=!0}function b(){c("BOOT CREATE"),f.state.start("main")}function d(){}function e(){}return{preload:a,create:b,update:d,render:e}},f=new Phaser.Game(800,480,Phaser.AUTO,"game");f.state.add("boot",new e),f.state.add("main",new d),f.state.start("boot"),document.getElementById("game").onwheel=b,document.getElementById("game").onmousewheel=b}();