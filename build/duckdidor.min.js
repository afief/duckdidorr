!function(){function a(a,b){function c(a){return a*a}var d=Math.sqrt(c(b.x-a.x)+c(b.y-a.y));return d}function b(a){a=a||window.event,a.preventDefault&&a.preventDefault(),a.returnValue=!1}var c=(console.log.bind(console),console.info.bind(console)),d=(console.warn.bind(console),console.error.bind(console),function(){function b(){if(w=0,A=100,x=0,y=0,C=3*Phaser.Timer.SECOND,B=!1,u&&(u.delay=C,u.timer.resume()),t&&(t.reload(),t.reload(),t.reload(),t.reload(),t.reload()),r&&(r.score.changeText("0"),r.duckPoin.changeText("0"),r.targetPoin.changeText("0")),G.bggroup){for(var a=G.bggroup.length-1;a>0;)G.bggroup.getChildAt(a).destroy(),a--;J+=1,J>=I.length&&(J=0),K=I[J],c(K),G.bg.frameName=K.bg,p.grass1.frameName=K.b1,p.grass2.frameName=K.b2}}function d(){G.bg=v.add.tileSprite(0,0,f.width,f.height,"stall",K.bg),G.bggroup=v.add.group(),G.bggroup.add(G.bg),p=v.add.group(),G.dashboard=v.add.sprite(0,f.height-115,"stand"),G.curtainTop=v.add.tileSprite(0,40,f.width,63,"stall","curtain_top"),G.curtain=v.add.sprite(0,0,"stall","curtain"),G.curtain2=v.add.sprite(0,0,"stall","curtain"),G.curtain2.scale.set(-1,1),G.curtain2.position.set(f.width,0),G.curtainStraight=v.add.tileSprite(0,0,f.width,80,"stall","curtain_straight"),p.grass1=new Phaser.TileSprite(v,-150,f.height,f.width+150,200,"stall",K.b1),p.grass1.anchor.set(0,1),p.grass2=new Phaser.TileSprite(v,-100,f.height+20,f.width+100,200,"stall",K.b2),p.grass2.anchor.set(0,1),p.add(p.grass1),p.add(p.grass2),v.add.tween(p.grass1).to({x:0},4e3,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0),v.add.tween(p.grass2).to({x:0},2500,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0),q=v.add.sprite(0,0,"hud",K.crosshair),q.anchor.set(.5,.5),s=v.add.sprite(f.width,f.height+150,"objects","rifle"),s.anchor.set(1,1),r=v.add.group(),r.coinIcon=v.add.sprite(70,15,"coin_gold"),r.coinIcon.scale.set(.6,.6),r.add(r.coinIcon),r.score=h("0","_small"),r.score.position.set(r.coinIcon.x+r.coinIcon.width+10,20),r.score.scale.set(.8,.8),r.add(r.score),r.iconDuck=v.add.sprite(600,20,"hud","icon_duck"),r.add(r.iconDuck),r.duckPoin=h("0","_small"),r.duckPoin.position.set(r.iconDuck.x+r.iconDuck.width+10,22),r.duckPoin.scale.set(.8,.8),r.add(r.duckPoin),r.iconTarget=v.add.sprite(700,20,"hud","icon_target"),r.add(r.iconTarget),r.targetPoin=h("0","_small"),r.targetPoin.position.set(r.iconTarget.x+r.iconTarget.width+10,22),r.targetPoin.scale.set(.8,.8),r.add(r.targetPoin);var a=v.add.image(10,10,"fullscreen-icon");a.scale.set(.9,.9),a.inputEnabled=!0,a.events.onInputDown.add(function(){f.scale.isFullScreen?f.scale.stopFullScreen():f.scale.startFullScreen(!1)},this)}function e(b,c){function d(c,d){if(t.shot()){var i=h.create(d.position.x-e.x,d.position.y-e.y,"objects","shot_blue_small");i.anchor.set(.5,.5);var j={x:e.x,y:e.y-e.target.height/2};D.indexOf(b)>=0&&(j.y+=e.target.height/4);var k=10-Math.floor(a(j,f.input)/5);k=0>k?0:k,g(e.x,e.y-h.height,k),w+=k,r.score.changeText(w.toString()),e.damage+=1,H.shot.play(),e.damage>=e.maxDamage?(e.target.inputEnabled=!1,v.add.tween(h).to({y:f.height},800,Phaser.Easing.Cubic.In,!0),v.add.tween(h.scale).to({y:.4,x:.8},500,Phaser.Easing.Cubic.InOut,!0),D.indexOf(b)>=0?(x+=1,r.duckPoin.changeText(x.toString())):(y+=1,r.targetPoin.changeText(y.toString())),H.coin2.play()):H.coin.play()}}var e=v.add.group(),h=v.add.group();return e.target=h.create(0,0,"objects",b),e.add(h),e.stick=e.create(0,0,"objects",c),e.target.anchor.set(.5,1),e.stick.anchor.set(.5,1),e.stick.y=e.stick.height,e.maxDamage=3,e.damage=0,e.target.inputEnabled=!0,e.target.input.pixelPerfectClick=!0,e.target.events.onInputDown.add(d),e}function g(a,b,c){function d(){e.destroy()}var e=h("+"+c.toString(),"_small");e.x=a-e.width/2,e.y=b,v.add.tween(e).to({y:b-100,alpha:0},1e3,Phaser.Easing.Quadratic.Out,!0).onComplete.add(d)}function h(a,b,c){function d(a){for(var d=0,g=0;g<a.length;g++)" "==a[g]?d+=10:(f.create(d,0,"hud",e(a[g],b)),d+=f.getChildAt(f.children.length-1).width);if(c){var h=f.width;for(g=0;g<f.length;g++)f.getChildAt(g).x-=h}}function e(a,b){return"+"==a?"text_plus"+b:"x"==a?"text_cross"+b:":"==a?"text_dots"+b:"text_"+a+b}b=b||"";var f=v.add.group();return d(a),f.changeText=function(a){f.removeAll(),d(a)},f}function i(){H.shot=v.add.audio("shot"),H.reload=v.add.audio("reload"),H.coin=v.add.audio("coin"),H.coin2=v.add.audio("coin2"),H.bgm=v.add.audio("bgm"),H.bgm.loopFull(1)}function j(){function a(){var a=Math.floor(2*Math.random());0==a?b():d(),u.delay>1e3&&(u.delay-=50)}function b(){function a(){c("Finished"),q.stop(),o=void 0,q=void 0,i.destroy()}var b=Math.floor(2*Math.random()),d=D[Math.floor(Math.random()*D.length)],h=F[Math.floor(Math.random()*F.length)],i=e(d,h),j=250+50*Math.random(),k=j+20+30*Math.random(),l=5e3+5e3*Math.random(),m=1e3+3e3*Math.random();i.y=j,i.x=-100;var n=f.width+100;b&&(i.x=f.width+100,n=-100,i.target.scale.x=-1),p.addAt(i,g());var o=v.add.tween(i).to({x:n},l,Phaser.Easing.Linear.None,!0).onComplete.add(a),q=v.add.tween(i).to({y:k},m,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0)}function d(){function a(){v.time.events.add(Phaser.Timer.SECOND+3e3*Math.random(),b,this)}function b(){v.add.tween(j).to({y:f.height+150},400,Phaser.Easing.Quadratic.In,!0).onComplete.add(c),v.time.events.remove(b)}function c(){j.destroy()}var d=D.concat(E),h=d[Math.floor(Math.random()*d.length)],i=F[Math.floor(Math.random()*F.length)],j=e(h,i);j.x=100+Math.random()*(f.width-200),j.y=f.height+150;var k=260+40*Math.random();p.addAt(j,g()),v.add.tween(j).to({y:k},400,Phaser.Easing.Quadratic.Out,!0).onComplete.add(a)}function g(){var a=Math.floor(3*Math.random());return 0==a?0:1==a?p.getChildIndex(p.grass2)+1:p.getChildIndex(p.grass1)+1}u=v.time.events.add(C,a,this),u.loop=!0,a()}function k(){function a(){}function b(){}function d(){}function e(a,b){function c(){q.tweenDownFinish.start()}function d(){s.isShot=!1}if(t.shot()){q.tweenDown?(q.tweenDown.start(),s.isShot||v.add.tween(s).to({rotation:s.rotation+.1},400,Phaser.Easing.Cubic.Out,!0).onComplete.add(d)):(q.tweenDown=v.add.tween(q.scale).to({x:1.5,y:1.5},200,Phaser.Easing.Cubic.Out,!0),q.tweenDownFinish=v.add.tween(q.scale).to({x:1,y:1},200,Phaser.Easing.Cubic.In,!1),q.tweenDown.onComplete.add(c),q.tweenDownFinish,v.add.tween(s).to({rotation:s.rotation+.1},400,Phaser.Easing.Cubic.Out,!0).onComplete.add(d));var e=G.bggroup.create(b.position.x-G.bg.x,b.position.y-G.bg.y,"objects","shot_blue_small");e.anchor.set(.5,.5),e.alpha=.5,H.shot.play(),s.isShot=!0}}function g(a){f.input.mouse.wheelDelta==Phaser.Mouse.WHEEL_DOWN&&(h+=Math.abs(f.input.mouse.wheelDelta),h>=z&&(c("RELOAD"),t.reload(),h=0))}f.onPause.add(a),f.onResume.add(b),f.onFocus.add(d),G.bg.inputEnabled=!0,G.bg.events.onInputDown.add(e),f.input.mouse.mouseWheelCallback=g;var h=0}function l(){function a(){t.num<=0&&0>=A?n():t.num<=0&&(t.alerting.visible=!0,t.alerting.tween.resume())}function b(){t.x=f.width-150,t.y=f.height-50}function c(){t.reload()}t=v.add.group(),t.max=5,t.num=5,t.type="silver",t["long"]="short",t.number=h(A.toString(),"_small",!0),t.add(t.number),t.larik=[],t.alerting=t.create(-70,-75,"clickscroll"),t.alerting.visible=!1,t.alerting.tween=v.add.tween(t.alerting).to({alpha:0},300,Phaser.Easing.Cubic.Out,!0,0,-1,!0),t.alerting.tween.pause();for(var d=10,e=0;e<t.num;e++)t.larik.push(t.create(d,0,"hud","icon_bullet_"+t.type+"_"+t["long"])),d+=25;t.shot=function(){return!B&&(v.time.events.add(1e3,a,this),t.num>0&&f.input.y<G.dashboard.y&&f.input.y>60)?(t.larik[t.num-1].frameName="icon_bullet_empty_"+t["long"],t.num--,!0):!1},t.reload=function(){t.num<t.max&&A>0&&(t.num+=1,t.larik[t.num-1].frameName="icon_bullet_"+t.type+"_"+t["long"],H.reload.play(),t.alerting.visible&&(t.alerting.visible=!1,t.alerting.tween.pause()),A>0&&(A--,t.number.changeText(A.toString())))},b(),t.hitArea=new Phaser.Graphics(v),t.hitArea.beginFill(0,0),t.hitArea.drawRect(-90,-80,t.width+40,t.height+120),t.hitArea.endFill(),t.add(t.hitArea),t.hitArea.inputEnabled=!0,t.hitArea.events.onInputDown.add(c)}function m(){function a(){c!==!1&&c.destroy(),b.length>0?(c=h([b[0]]),c.x=f.width/2,c.y=f.height/2,c.getAt(0).anchor.set(.5,.5),c.getAt(0).position.set(0,0),b.splice(0,1),v.add.tween(c.getAt(0).scale).to({x:2,y:2},500,Phaser.Easing.Quadratic.Out,!0,0,0,!0).onComplete.add(a)):(B=!1,j())}var b=["ready","3","2","1","go"],c=!1;a()}function n(){function a(){e.destroy(),b()}function c(){e.destroy(),b(),o()}function d(a,b){function c(){v.add.tween(a.scale).to({x:1.5,y:1.5},400,Phaser.Easing.Quadratic.Out,!0)}function d(){v.add.tween(a.scale).to({x:b.x,y:b.y},400,Phaser.Easing.Quadratic.In,!0)}a.inputEnabled=!0,a.events.onInputDown.add(c),a.events.onInputOver.add(c),a.events.onInputOut.add(d)}if(!B){B=!0,u&&u.timer.pause();var e=v.add.group();e.create(0,0,"panel");e.x=f.width/2-e.width/2,e.y=f.height/2-e.height/2;var g=e.create(30,0,"hud","text_gameover");g.x=e.width/2-g.width/2,g.y=30,e.create(120,130,"coin_gold");var i=h(w.toString());i.x=200,i.y=135,e.add(i),e.create(100,220,"hud","icon_duck"),i=h(x.toString(),"_small"),i.x=150,i.y=220,e.add(i),e.create(260,220,"hud","icon_target"),i=h(y.toString(),"_small"),i.x=310,i.y=220,e.add(i);var j=e.create(110,360,"bt_home");j.anchor.set(.5,.5),d(j,{x:1,y:1}),j.events.onInputUp.add(c);var k=e.create(330,360,"bt_replay");k.anchor.set(.5,.5),k.scale.set(.9,.9),d(k,{x:.9,y:.9}),k.events.onInputUp.add(a)}}function o(){function a(){h.scale.set(1.2,1.2),h.tint=16755217}function b(){h.scale.set(1,1),h.tint=16777215}function c(){h.events.onInputOver.remove(a),h.events.onInputOut.remove(b),h.events.onInputUp.remove(c),h.destroy(),m(),e.tw1=v.add.tween(e).to({y:-800},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(d),e.tw2=v.add.tween(e).to({x:10},250,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0)}function d(){e.destroy(),g.destroy()}B=!0;var e=v.add.tileSprite(-10,0,f.width+20,f.height,"tirai"),g=v.add.sprite(f.width/2,f.height/2,"judul"),h=v.add.sprite(f.width/2,f.height/2+150,"play");e.addChild(g),g.anchor.set(.5,1),h.anchor.set(.5,.5),h.inputEnabled=!0,h.events.onInputOver.add(a),h.events.onInputOut.add(b),h.events.onInputUp.add(c)}var p,q,r,s,t,u,v=this,w=0,x=0,y=0,z=3,A=100,B=!0,C=3*Phaser.Timer.SECOND,D=["duck_brown","duck_outline_brown","duck_outline_target_brown","duck_outline_target_white","duck_outline_target_yellow","duck_outline_white","duck_outline_yellow","duck_target_brown","duck_target_white","duck_target_yellow","duck_white","duck_yellow"],E=["target_colored","target_colored_outline","target_red1","target_red1_outline","target_red2","target_red2_outline","target_red3","target_red3_outline","target_white","target_white_outline"],F=["stick_metal","stick_metal_outline","stick_wood","stick_wood_outline"],G={},H={},I=[{bg:"bg_wood",b1:"grass1",b2:"grass2",crosshair:"crosshair_blue_large"},{bg:"bg_blue",b1:"water1",b2:"water2",crosshair:"crosshair_red_large"}],J=Math.floor(Math.random()*I.length),K=I[J];this.preload=function(){c("MAIN PRELOAD"),v.add.sprite(f.width/2,f.height/4*1.5,"logo").anchor.setTo(.5,.5),v.add.sprite(f.width/2,f.height/4*3,"loader-white").anchor.setTo(.5,.5);var a=v.add.sprite(f.width/2,f.height/4*3,"loader-black");a.anchor.setTo(.5,.5),v.load.setPreloadSprite(a,0),v.load.atlasXML("stall","assets/spritesheet_stall.png","assets/spritesheet_stall.xml"),v.load.atlasXML("objects","assets/spritesheet_objects.png","assets/spritesheet_objects.xml"),v.load.atlasXML("hud","assets/spritesheet_hud.png","assets/spritesheet_hud.xml"),v.load.image("stand","assets/stand.png"),v.load.image("coin_gold","assets/coin_gold.png"),v.load.image("fullscreen-icon","assets/fullscreen-icon.png"),v.load.image("panel","assets/panel.png"),v.load.image("bt_replay","assets/replay.png"),v.load.image("play","assets/play.png"),v.load.image("bt_home","assets/home.png"),v.load.image("clickscroll","assets/clickscroll.png"),v.load.image("tirai","assets/tirai.png"),v.load.image("judul","assets/judul.png"),v.load.audio("shot","assets/sounds/barreta_m9-Dion_Stapper-1010051237.mp3"),v.load.audio("reload","assets/sounds/reload.mp3"),v.load.audio("coin","assets/sounds/coin1.wav"),v.load.audio("coin2","assets/sounds/coin2.wav"),v.load.audio("bgm","assets/Retro Comedy.ogg"),f.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,f.canvas.oncontextmenu=function(a){a.preventDefault()}},this.create=function(){c("MAIN CREATE"),d(),k(),i(),l(),o()},this.update=function(){f.input.y<G.dashboard.y&&f.input.y>60&&(q.position.set(f.input.x,f.input.y),s.x=f.input.x+220,s.isShot||(s.rotation=.2-f.input.y/(f.height-115)*.4))},this.render=function(){}}),e=function(){function a(){c("BOOT PRELOAD"),f.load.image("logo","assets/logo.png"),f.load.image("loader-white","assets/loader_white.png"),f.load.image("loader-black","assets/loader_black.png"),f.stage.disableVisibilityChange=!0}function b(){c("BOOT CREATE"),f.state.start("main")}function d(){}function e(){}return{preload:a,create:b,update:d,render:e}},f=new Phaser.Game(800,480,Phaser.AUTO,"game");f.state.add("boot",new e),f.state.add("main",new d),f.state.start("boot"),document.getElementById("game").onwheel=b,document.getElementById("game").onmousewheel=b}();